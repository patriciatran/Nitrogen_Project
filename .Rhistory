folder.path <- "/Volumes/mcmahonlab/home/ptran/depthsfromSarah/"
metadata <- read.csv(folder = folder.path/ME_metadata.all.txt)
metadata <- read.csv("/Volumes/mcmahonlab/home/ptran/depthsfromSarah/ME_metadata.all.txt")
View(metadata)
metadata <- read.csv("/Volumes/mcmahonlab/home/ptran/depthsfromSarah/ME_metadata.all.txt", sep="\t")
View(metadata)
temp = list.files(pattern="*.95PID.txt")
mapping.data <- lapply(temp, read.delim)
read.delim(file="filename", header=TRUE, sep="\t")
temp <- list.files(pattern="*.95PID.txt")
temp <- list.files(pattern="*.txt")
temp <- list.files(folder= folder.path,pattern="*.txt")
temp <- list.files(path= folder.path, pattern="*.txt")
temp <- list.files(path= folder.path, pattern="*.95PID.txt")
read.delim(file="filename", header=TRUE, sep="\t")
mapping.data <- lapply(temp, read.delim)
mapping.data <- lapply(path=folder.path, temp, read.delim)
file.names <- list.files(path= folder.path, pattern="*.95PID.txt")
import.Mapping.data <- function(folder){
file.names <- list.files(path= folder.path, pattern="*.95PID.txt")
}
mapping.data <- import.Mapping.data(folder=folder.path)
import.multiple.csv.files<-function(mypath,mypattern,...)
{
tmp.list.1<-list.files(mypath, pattern=mypattern)
tmp.list.2<-list(length=length(tmp.list.1))
for (i in 1:length(tmp.list.1)){tmp.list.2[[i]]<-read.csv(tmp.list.1[i],...)}
names(tmp.list.2)<-tmp.list.1
tmp.list.2
}
csv.import<-import.multiple.csv.files(mypath=folder.path,".95PID.txt",sep="\t")
csv.import<-import.multiple.csv.files(folder.path,".95PID.txt",sep="\t")
csv.import<-import.multiple.csv.files(folder.path,".95PID.txt",sep="\t")
csv.import<-import.multiple.csv.files(folder.path,".95PID.txt",sep="\t")
csv.import<-import.multiple.csv.files(folder.path,"95PID.txt$",sep="\t")
mapping.data <- import.Sample.Data(folder = folder.path, chosen.years = "all")
csv.import<-import.multiple.csv.files(folder.path,"95PID.txt$",sep="\t")
n_mags <- read.csv("~/Dropbox/McMahonLab_Project/Nitrogen_Project/Metagenome/n_mags.csv")
View(n_mags)
library(reshape)
mdata <- melt(n_mags, id=c("bin","date"))
View(n_mags)
mdata <- melt(n_mags, id=c("Season","Date"))
View(mdata)
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
View(mdata)
#try(library(Hmisc), install.packages("Hmisc"))
try(library(reshape), install.packages("reshape"))
try(library(ggplot2), install.packages("ggplot2"))
try(library(RColorBrewer), install.packages("RColorBrewer"))
data$Guild <- factor(data$Guild, levels=rev(union(data$Guild,data$Guild))) # reorder family levels
#plot
quartz()
myPalette <- colorRampPalette(brewer.pal(9, "Reds"))
ggplot(data, aes(x=location, y=rel, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~location) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
data <- read.table("~/Downloads/peptidase.csv", header=T, sep=",")
View(data)
# reorder taxa based on orginal data file
data$bin <- factor(data$bin, levels=c("AMX1","CHB2","CHB7","BCD10","CFX11","CFX17","PRO15","PRO8")) # reorder bin levels
data$family <- factor(data$family, levels=rev(union(data$family,data$family))) # reorder family levels
myPalette <- colorRampPalette(brewer.pal(9, "Reds"))
ggplot(data, aes(x=location, y=rel, group=family, color=rel)) + geom_point(aes(y=family, x=bin, size=count)) +
facet_wrap(~location) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=family, x=bin, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=Date, group=Date)) + geom_point(aes(y=family, x=bin, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=value, group=Date)) + geom_point(aes(y=family, x=bin, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=Date, group=Date)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=Date)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(data, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
myPalette <- colorRampPalette(brewer.pal(9, "Reds"))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_fill_manual(values = brewer.pal(name="Set1", n=5), guide="none") +
scale_alpha_manual(values=c(0.8, 0.6, 0.4))+
theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value, drop=TRUE)) +
facet_wrap(~Guild, drop=TRUE) +
theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, size=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1),
legend.spacing.y=2)
ggplot(mdata, aes(x=Guild, y=Date, group=Season, color=value)) + geom_point(aes(y=Season, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Season, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
mdata <- as.Date(mdata$Date)
mdata <- melt(n_mags, id=c("Season","Date"))
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata <- as.Date(mdata$Date, format="%yyy-%mm-%yy")
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata <- melt(n_mags, id=c("Season","Date"))
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata$date <- as.Date(mdata$Date, format="%yyy-%mm-%yy")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
class(mdata$date)
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
mdata$date <- as.Date(mdata$Date, format="%yyyy-%mm-%dd")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
today <- Sys.Date()
today
format(today, format="%B %d %Y")
mdata$date <- as.Date(mdata$Date, format="%y-%m-%d")
View(mdata)
mdata$date <- as.Date(mdata$Date)
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, fill=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color="black")) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
value
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
# Select just the AOB
aob <- subset(mdata$Guild="AOB")
# Select just the AOB
aob <- subset(mdata$Guild=="AOB")
# Select just the AOB
aob <- subset(mdata, mdata$Guild=="AOB")
View(aob)
#AOB:
# Select just the AOB
aob <- subset(mdata, mdata$Guild=="AOB")
ggplot(aob, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~., drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~.) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
