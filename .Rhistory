facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
theme(panel.background = element_rect(fill='white'),axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=Date, group=Date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
mdata <- as.Date(mdata$Date)
mdata <- melt(n_mags, id=c("Season","Date"))
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata <- as.Date(mdata$Date, format="%yyy-%mm-%yy")
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata <- melt(n_mags, id=c("Season","Date"))
mdata$Guild <- ifelse(grepl("Nitroso", mdata$variable), "AOB", "NOB")
mdata$date <- as.Date(mdata$Date, format="%yyy-%mm-%yy")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=Date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
class(mdata$date)
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
mdata$date <- as.Date(mdata$Date, format="%yyyy-%mm-%dd")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
today <- Sys.Date()
today
format(today, format="%B %d %Y")
mdata$date <- as.Date(mdata$Date, format="%y-%m-%d")
View(mdata)
mdata$date <- as.Date(mdata$Date)
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "1 month", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y")
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, fill=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color="black")) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
value
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value, colour="black")) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
# Select just the AOB
aob <- subset(mdata$Guild="AOB")
# Select just the AOB
aob <- subset(mdata$Guild=="AOB")
# Select just the AOB
aob <- subset(mdata, mdata$Guild=="AOB")
View(aob)
#AOB:
# Select just the AOB
aob <- subset(mdata, mdata$Guild=="AOB")
ggplot(aob, aes(x=Guild, y=date, group=date, color=value)) + geom_point(aes(y=date, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_y_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=variable, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=Guild, group=Guild, color=value)) + geom_point(aes(y=Guild, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~., drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mdata, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(Guild~.) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(aob, aes(x=date, y=variable, group=variable, color=value)) + geom_point(aes(y=variable, x=date, size=value)) +
facet_wrap(~Guild, drop=TRUE) +
scale_colour_gradientn(colours = myPalette(9)) +
scale_x_date(date_breaks = "2 months", date_labels =  "%b %Y") +
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
View(aob)
View(data)
View(mdata)
View(n_mags)
View(mdata)
# Then, you define the type of plot (a scatter plot is "geom_point")
my_plot <- ggplot(mdata, aes(date, variable, size=value, color=Guild))
# Then, you define the type of plot (a scatter plot is "geom_point")
library(ggplot2)
my_plot <- ggplot(mdata, aes(date, variable, size=value, color=Guild))
my_plot + geom_point() +
# This is for the gradient of the points.
# scale_color_hue(l=40, c=35) +
# To make a two colour gradient use (you can change the colours) (you can use Hex colours too : eg. #132B43)
scale_fill_gradient(low="white", high="red", mid=50)
my_plot + geom_point() +
scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Time (Week)") +
ylab("Treatment")+
ggtitle("Shannon index")+
theme(legend.position="bottom")
my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Time (Week)") +
ylab("Treatment")+
ggtitle("Shannon index")+
theme(legend.position="bottom")
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")+
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
facet_wrap(~Guild, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")+
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
facet_wrap(~Guild., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")+
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
facet_wrap(Guild~, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")+
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
facet_wrap(Guild~, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom")+
theme(panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot<- my_plot + geom_point() +
# scale_fill_gradient(low="white", high="red", mid=50)+
xlab("Date") +
ylab("Treatment")+
facet_wrap(Guild~, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Treatment")+
facet_wrap(Guild~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
p <- ggplot(mpg, aes(displ, cty)) + geom_point()
p + facet_grid(. ~ cyl)
p + facet_grid(drv ~ .)
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Treatment")+
facet_grid(Guild~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(Guild~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(Guild~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(Guild~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
facet_grid(Season~., drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='light grey'),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel..grid.major=element_line(linetype="dashed"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="black"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="grey"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="grey"),
panel.border = element_rect(linetype = "solid", fill = NA, colour="grey")
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "4 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="grey"),
panel.border = element_rect(linetype = "solid", fill = NA, colour="grey"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
View(n_mags)
heatmap_dendogram <- (n_mags[2:10])
heatmap_dendogram <- heatmap(n_mags[2:10])
heatmap_dendogram <- heatmap(as.matrix(n_mags[2:10]))
n_mags.matrix <- as.matrix(n_mags[,2:10])
heatmap_dendogram <- heatmap(n_mags.matrix)
View(n_mags.matrix)
row.names(n_mags.matrix) <- n_mags[,1]
row.names(n_mags.matrix) <- n_mags[,2]
n_mags.matrix <- n_mags.matrix[,-1]
heatmap_dendogram <- heatmap(n_mags.matrix)
View(n_mags.matrix)
heatmap_dendogram <- heatmap(as.numeric(n_mags.matrix))
heatmap_dendogram <- heatmap.2(as.numeric(n_mags.matrix))
class(n_mags.matrix)
class(n_mags.matrix) <- "numeric"
heatmap_dendogram <- heatmap.2(as.numeric(n_mags.matrix))
heatmap_dendogram <- heatmap(as.numeric(n_mags.matrix))
apply(n_mags.matrix, 1,as.numeric)
mags.matrix <- apply(n_mags.matrix, 1,as.numeric)
View(mags.matrix)
n_mags.matrix <- as.matrix(n_mags[,2:10])
row.names(n_mags.matrix) <- n_mags[,2]
n_mags.matrix <- n_mags.matrix[,-1]
mags.matrix <- apply(n_mags.matrix, 1,as.numeric)
View(mags.matrix)
n_mags.matrix <- as.matrix(n_mags[,2:10])
View(n_mags.matrix)
row.names(n_mags.matrix) <- n_mags[,2]
n_mags.matrix <- n_mags.matrix[,-1]
mode(n_mags.matrix) <- "numeric"
View(n_mags.matrix)
heatmap_dendogram <- heatmap(n_mags.matrix)
heatmap_dendogram <- heatmap(n_mags.matrix, cexRow=0.50)
heatmap_dendogram <- heatmap(n_mags.matrix, cexCol=0.50)
heatmap_dendogram <- heatmap(n_mags.matrix, cexCol=0.30)
n_plot
heatmap_dendogram <- heatmap(n_mags.matrix, cexCol=0.80)
heatmap.2(n_mags.matrix, colsep=c(1:6),rowsep=(1:62),
sepwidth=c(0.05,0.05), sepcolor="white", trace="none",
Rowv=F,Colv=F, scale="none", dendrogram="none",key=F,
lhei = c(0.05,5),margins=c(1,8))
library(gplot2)
library(gplots)
install.packages("gplots")
library(gplots)
heatmap.2(n_mags.matrix, colsep=c(1:6),rowsep=(1:62),
sepwidth=c(0.05,0.05), sepcolor="white", trace="none",
Rowv=F,Colv=F, scale="none", dendrogram="none",key=F,
lhei = c(0.05,5),margins=c(1,8))
heatmap.2(n_mags.matrix,sepwidth=c(0.05,0.05), sepcolor="white", trace="none",
Rowv=T,Colv=T, scale="none", dendrogram="none",key=F,
lhei = c(0.05,5),margins=c(1,8))
heatmap.2(n_mags.matrix,sepwidth=c(0.05,0.05), sepcolor="white", trace="none",
Rowv=T,Colv=T, scale="none", dendrogram="none",key=T,
lhei = c(0.05,5),margins=c(1,8))
heatmap_dendogram <- heatmap(n_mags.matrix, cexCol=0.80)
heatmap_dendogram <- heatmap(n_mags.matrix, cexCol=0.80)
# plot basic tree
plot(as.phylo(n_mags.matrix), cex = 0.9, label.offset = 1)
# load package ape; remember to install it: install.packages('ape')
library(ape)
install.packages('ape')
library(ape)
# plot basic tree
plot(as.phylo(n_mags.matrix), cex = 0.9, label.offset = 1)
View(n_mags.matrix)
class(n_mags.matrix)
hc <- hclust(dist(n_mags.matrix))
plot(hc)
nba_heatmap <- heatmap(n_mags.matrix, Rowv=NA, Colv=NA, col = cm.colors(256), scale="column", margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T, col = cm.colors(256), scale="column", margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = col = heat.colors(256), scale="column",
margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = col = heat.colors(256), scale="column",
margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = col = heat.colors(256), scale="column",
margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = heat.colors(256), scale="column",
margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = heat.colors(256), scale="none",
margins=c(5,10))
nba_heatmap <- heatmap(n_mags.matrix, Rowv=T, Colv=T,
col = heat.colors(256), scale="row",
margins=c(5,10))
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="grey"),
panel.border = element_rect(linetype = "solid", fill = NA, colour="grey"),
axis.text.x = element_text(angle = 90, hjust = 1))
library(ggplot2)
n_plot<- my_plot + geom_point() +
xlab("Date") +
ylab("Metagenome name")+
#facet_grid(~Season, drop=TRUE) +
ggtitle("Reads mapped to each Metagenome accross time")+
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
theme(legend.position="bottom", panel.background = element_rect(fill='white'),
panel.grid.major=element_line(linetype="dashed", colour="grey"),
panel.border = element_rect(linetype = "solid", fill = NA, colour="grey"),
axis.text.x = element_text(angle = 90, hjust = 1))
n_plot
