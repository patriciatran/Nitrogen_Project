#Bubble plot

#try(library(Hmisc), install.packages("Hmisc"))
try(library(reshape), install.packages("reshape"))
try(library(ggplot2), install.packages("ggplot2"))
try(library(RColorBrewer), install.packages("RColorBrewer"))

# melted data 
setwd("/Users/christopherlawson/Documents/R_stuff/raw")
data <- read.table("~/Downloads/peptidase.csv", header=T, sep=",")

# reorder taxa based on orginal data file
data$bin <- factor(data$bin, levels=c("AMX1","CHB2","CHB7","BCD10","CFX11","CFX17","PRO15","PRO8")) # reorder bin levels
data$family <- factor(data$family, levels=rev(union(data$family,data$family))) # reorder family levels

#plot
quartz()

# Select just the AOB
aob <- subset(mdata, mdata$Guild=="AOB")

myPalette <- colorRampPalette(brewer.pal(9, "Reds"))
ggplot(data, aes(x=location, y=rel, group=family, color=rel)) + geom_point(aes(y=family, x=bin, size=count)) + 
  facet_wrap(~location) + scale_colour_gradientn(colours = myPalette(9)) + theme(panel.background = element_rect(fill='white'))



